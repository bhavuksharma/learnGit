name: Pull Request Merged 

on:
    pull_request: 
        branches: [ master ]
        types: [ closed ]
jobs: 
    pr-merged:
        if: github.event.pull_request.merged == true
        runs-on: ubuntu-latest

        steps:
            - name: Checkout Repository
              uses: actions/checkout@v2

            - name: Set jfrog CLI
              uses: jfrog/setup-jfrog-cli@v4
              with:
                version: 'latest'

            # - name: Ping Jfrog
            #   run: |
            #     jf rt ping

            #upload artifacts to jfrog repository
            - name: ping jfrog
              env: 
                JF_URL: ${{ vars.JF_URL }}
                JF_ACCESS_TOKEN: ${{ secrets.JFROG_TOKEN }}
                JF_USER: ${{ secrets.JFROG_USER }}
              run: |
                jf rt ping --url $JF_URL --user $JF_USER --access-token $JF_ACCESS_TOKEN
                jf rt u "prcm/*" "prch-config-generic-local/" --url $JF_URL --user $JF_USER --access-token $JF_ACCESS_TOKEN